(()=>{var e={};e.id=24,e.ids=[24],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8416:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>p,pages:()=>d,routeModule:()=>u,tree:()=>o});var a=s(7096),r=s(6132),n=s(7284),i=s.n(n),l=s(2564),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);s.d(t,c);let o=["",{children:["paste",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,6671)),"/home/sumedh/Code/pasteCTL/frontend/app/paste/[id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,6015)),"/home/sumedh/Code/pasteCTL/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"]}],d=["/home/sumedh/Code/pasteCTL/frontend/app/paste/[id]/page.tsx"],p="/paste/[id]/page",m={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/paste/[id]/page",pathname:"/paste/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},3747:(e,t,s)=>{Promise.resolve().then(s.bind(s,1214))},1214:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>PastePage});var a=s(784),r=s(9885),n=s(7114),i=s(5555),l=s(599),c=s(1971),o=s(8699);let d=(0,c.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Badge({className:e,variant:t,...s}){return a.jsx("div",{className:(0,o.cn)(d({variant:t}),e),...s})}var p=s(6388),m=s(2388),u=s(517),x=s(5441),h=s(2385),g=s(1234),b=s(3307),f=s(9941),v=s(9268);function PastePage(){let e=(0,n.useParams)(),t=(0,n.useRouter)(),s=e.id,[c,o]=(0,r.useState)(null),[d,j]=(0,r.useState)(!0),[N,y]=(0,r.useState)(""),[w,P]=(0,r.useState)(null),_=(0,r.useRef)(null),C=(0,r.useRef)(null),k=(0,r.useRef)(""),S=(0,r.useRef)(!1),T=(0,r.useCallback)(async()=>{try{j(!0);let e=await fetch(`https://api.paste.sumedh.app/api/pastes/${s}`);if(!e.ok){404===e.status?P("Paste not found"):P("Failed to load paste");return}let t=await e.json();o(t),y(t.content),S.current||(S.current=!0,await incrementViews()),P(null)}catch(e){P("Failed to load paste"),console.error("Error fetching paste:",e)}finally{j(!1)}},[s]),incrementViews=async()=>{try{await fetch(`https://api.paste.sumedh.app/api/pastes/${s}/view`,{method:"PUT"})}catch(e){console.error("Error incrementing views:",e)}},E=(0,r.useCallback)(()=>{if(_.current?.readyState===WebSocket.OPEN)return;let e=new WebSocket(`wss://api.paste.sumedh.app/api/ws/${s}`);e.onopen=()=>console.log("WebSocket connected"),e.onmessage=e=>{try{let t=JSON.parse(e.data);"content_update"===t.type&&t.content!==k.current&&(y(t.content),o(e=>e?{...e,content:t.content}:null))}catch(e){console.error("Error parsing WebSocket message:",e)}},e.onerror=e=>console.error("WebSocket error:",e),e.onclose=()=>{console.log("WebSocket disconnected, reconnecting in 2s..."),setTimeout(()=>E(),2e3)},_.current=e},[s]),Z=(0,r.useCallback)(e=>{e!==k.current&&(k.current=e,_.current?.readyState===WebSocket.OPEN&&_.current.send(JSON.stringify({type:"content_update",content:e})),C.current&&clearTimeout(C.current),C.current=setTimeout(async()=>{try{await fetch(`https://api.paste.sumedh.app/api/pastes/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:e})}),console.log("Auto-saved paste to backend")}catch(e){console.error("Error auto-saving paste:",e)}},1e3))},[s]),q=(0,r.useCallback)(e=>{y(e),Z(e)},[Z]),copyToClipboard=async()=>{try{await navigator.clipboard.writeText(N),f.Am.success("Copied to clipboard")}catch{f.Am.error("Failed to copy")}},createNewPaste=()=>t.push("/");return((0,r.useEffect)(()=>(T(),E(),()=>{_.current&&_.current.close(),C.current&&clearTimeout(C.current)}),[T,E]),d)?(0,a.jsxs)("div",{className:"min-h-screen bg-slate-900",children:[a.jsx(b.h,{}),a.jsx("div",{className:"flex items-center justify-center h-96",children:a.jsx("div",{className:"animate-pulse text-slate-400",children:"Loading paste..."})})]}):w||!c?(0,a.jsxs)("div",{className:"min-h-screen bg-slate-900",children:[a.jsx(b.h,{}),(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-96",children:[a.jsx("div",{className:"text-red-400 text-xl mb-4",children:w||"Paste not found"}),a.jsx(i.z,{onClick:createNewPaste,className:"bg-emerald-600 hover:bg-emerald-700",children:"Create New Paste"})]})]}):(0,a.jsxs)("div",{className:"min-h-screen bg-slate-900",children:[a.jsx(b.h,{}),(0,a.jsxs)("main",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold text-white mb-2",children:["Paste #",c.id]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)(i.z,{onClick:copyToClipboard,variant:"secondary",className:"bg-slate-700 hover:bg-slate-600 text-white",children:[a.jsx(p.Z,{className:"w-4 h-4 mr-2"})," Copy"]}),a.jsx(i.z,{onClick:()=>{window.open(`https://api.paste.sumedh.app/api/pastes/${s}/raw`,"_blank")},variant:"secondary",className:"bg-slate-700 hover:bg-slate-600 text-white",children:"Raw"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[a.jsx("div",{className:"lg:col-span-3",children:a.jsx(g.p,{value:N,onChange:q,language:c.language,readOnly:!1,height:"500px"})}),(0,a.jsxs)("div",{className:"space-y-6",children:[a.jsx(l.Zb,{className:"bg-slate-800 border-slate-700",children:(0,a.jsxs)(l.aY,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(m.Z,{className:"w-4 h-4 text-emerald-400"}),a.jsx("h3",{className:"font-semibold text-white",children:"Paste Info"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-sm text-slate-400 mb-1",children:"Language"}),a.jsx(Badge,{variant:"secondary",className:"bg-slate-700 text-white",children:c.language})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-sm text-slate-400 mb-1 flex items-center gap-2",children:[a.jsx(m.Z,{className:"w-3 h-3"})," Views"]}),a.jsx("div",{className:"text-white font-semibold",children:c.views})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-sm text-slate-400 mb-1 flex items-center gap-2",children:[a.jsx(u.Z,{className:"w-3 h-3"})," Created"]}),a.jsx("div",{className:"text-sm text-white",children:(0,v.ZP)(new Date(c.created_at),"MMM dd, yyyy, hh:mm a")})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-sm text-slate-400 mb-1 flex items-center gap-2",children:[a.jsx(x.Z,{className:"w-3 h-3"})," Expires"]}),a.jsx("div",{className:"text-sm text-white",children:(e=>{if(!e)return"Never expires";let t=new Date(e);return isNaN(t.getTime())?"Never expires":(0,v.ZP)(t,"MMM dd, yyyy, hh:mm a")})(c.expire_at)})]})]})]})}),a.jsx(l.Zb,{className:"bg-slate-800 border-slate-700",children:(0,a.jsxs)(l.aY,{className:"p-6",children:[a.jsx("h3",{className:"font-semibold text-white mb-4",children:"Actions"}),(0,a.jsxs)(i.z,{onClick:createNewPaste,className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white",children:[a.jsx(h.Z,{className:"w-4 h-4 mr-2"})," New paste"]})]})}),a.jsx(l.Zb,{className:"bg-slate-800 border-slate-700",children:a.jsx(l.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 bg-emerald-400 rounded-full animate-pulse"}),a.jsx("span",{className:"text-sm text-emerald-400",children:"Live editing"})]})})})]})]})]})]})}},6671:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>n,default:()=>c});var a=s(5153);let r=(0,a.createProxy)(String.raw`/home/sumedh/Code/pasteCTL/frontend/app/paste/[id]/page.tsx`),{__esModule:n,$$typeof:i}=r,l=r.default,c=l}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[518,843,446,896,672],()=>__webpack_exec__(8416));module.exports=s})();